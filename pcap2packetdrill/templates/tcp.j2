// TCP Packetdrill script generated by PCAP2Packetdrill
// Client: {{ client_ip }}:{{ client_port }}
// Server: {{ server_ip }}:{{ server_port }}

// ===== Test Preconditions =====
{% if preconditions %}
// Preconditions:
{% for precondition in preconditions %}
// - {{ precondition }}
{% endfor %}
{% endif %}

// Initialize the client socket
0 socket(..., SOCK_STREAM, IPPROTO_TCP) = 3

// Socket options
0 setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
0 setsockopt(3, SOL_TCP, TCP_NODELAY, [1], 4) = 0

// Bind to client address
0 bind(3, ..., ...) = 0
0 connect(3, {sa_family=AF_INET, sin_port=htons({{ server_port }}), sin_addr={{server_ip}}}, ...) = 0

// ===== Packet Trace =====
// This section contains the actual network traffic captured in the PCAP
{% for packet in packets %}
{{ packet }}
{% endfor %}

// ===== Test Postconditions =====
{% if postconditions %}
// Postconditions:
{% for postcondition in postconditions %}
// - {{ postcondition }}
{% endfor %}
{% endif %}

// Gracefully close the connection (if applicable)
+0.100 close(3) = 0
