// SCTP Replay Test Generated by PCAP2Packetdrill
// Generated from complete SCTP association cycle
// Client: {{ client_ip }}:{{ client_port }}
// Server: {{ server_ip }}:{{ server_port }}

// ===== Test Description =====
// This test replays a complete SCTP association cycle including:
// - Association establishment (INIT, INIT-ACK, COOKIE-ECHO, COOKIE-ACK)
// - Data exchange
// - Association termination (SHUTDOWN sequence)

// ===== Test Preconditions =====
{% if preconditions %}
// Preconditions:
{% for precondition in preconditions %}
// - {{ precondition }}
{% endfor %}
{% endif %}

// ===== Socket Setup =====
// Initialize the client socket
0 socket(..., SOCK_STREAM, IPPROTO_SCTP) = 3

// Socket options
0 setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
0 setsockopt(3, IPPROTO_SCTP, SCTP_NODELAY, [1], 4) = 0

// Bind to client address
0 bind(3, ..., ...) = 0
0 connect(3, {sa_family=AF_INET, sin_port=htons({{ server_port }}), sin_addr={{ server_ip }}}, ...) = 0

// ===== Association Replay =====
// The following section is an exact replay of a captured SCTP association
// All packet timings, TSNs, chunk sequences, and payload data are preserved
{% for packet in packets %}
{{ packet }}
{% endfor %}

// ===== Test Postconditions =====
{% if postconditions %}
// Postconditions:
{% for postcondition in postconditions %}
// - {{ postcondition }}
{% endfor %}
{% endif %}

// Close the association
+0.100 close(3) = 0
